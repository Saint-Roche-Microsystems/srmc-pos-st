<div class="flex-1 p-6 md:p-10 bg-gradient-to-br from-slate-50 to-white overflow-y-auto">
  <div class="max-w-7xl mx-auto">

    <!-- Header -->
    <div class="flex flex-col md:flex-row md:items-end justify-between mb-10 gap-6">
      <div>
        <h1 class="text-4xl font-black text-slate-900 tracking-tight">
          Inventory
        </h1>
        <p class="text-slate-500 text-lg">
          Manage your products, prices and stock availability.
        </p>
      </div>

      <p-button label="New Product" icon="pi pi-plus" severity="primary" (click)="showDialog()"
        styleClass="rounded-2xl px-6 py-3 shadow-lg shadow-blue-500/20 hover:shadow-blue-500/30 transition-all">
      </p-button>
    </div>

    <!-- Table Card -->
    <div class="bg-white rounded-[2.5rem]
             shadow-[0_25px_60px_-15px_rgba(0,0,0,0.08)]
             border border-slate-100 overflow-hidden">

      <p-table [value]="posService.products()" [tableStyle]="{ 'min-width': '60rem' }" styleClass="p-datatable-sm">

        <!-- Header -->
        <ng-template pTemplate="header">
          <tr>
            <th class="bg-white px-6 py-5 border-b border-slate-100">
              <div class="flex justify-center text-slate-400 font-bold uppercase tracking-wider text-[11px]">
                Product
              </div>
            </th>
            <th class="bg-white px-6 py-5 border-b border-slate-100">
              <div class="flex justify-center text-slate-400 font-bold uppercase tracking-wider text-[11px]">
                Price
              </div>
            </th>
            <th class="bg-white px-6 py-5 border-b border-slate-100">
              <div class="flex justify-center text-slate-400 font-bold uppercase tracking-wider text-[11px]">
                Stock
              </div>
            </th>
            <th class="bg-white px-6 py-5 border-b border-slate-100">
              <div class="flex justify-center text-slate-400 font-bold uppercase tracking-wider text-[11px]">
                Status
              </div>
            </th>
            <th class="bg-white px-6 py-5 border-b border-slate-100">
              <div class="flex justify-center text-slate-400 font-bold uppercase tracking-wider text-[11px]">
                Actions
              </div>
            </th>
          </tr>
        </ng-template>



        <!-- Body -->
        <ng-template pTemplate="body" let-product>
          <tr class="hover:bg-slate-50 transition-colors duration-200">

            <!-- Product -->
            <td class="px-6 py-5">
              <div class="flex items-center gap-4">
                <div class="w-14 h-14 rounded-2xl bg-slate-100 flex items-center justify-center
                         overflow-hidden border border-white shadow-inner">
                  @if (product.image) {
                  <img [src]="product.image" class="w-full h-full object-cover">
                  } @else {
                  <i class="pi pi-image text-slate-400 text-xl"></i>
                  }
                </div>

                <div>
                  <span class="block font-bold text-slate-900 leading-tight">
                    {{ product.name }}
                  </span>
                  <span class="text-xs text-slate-400">
                    Product Item
                  </span>
                </div>
              </div>
            </td>

            <!-- Price -->
            <td class="px-6 py-5 text-right">
              <span class="text-xl font-black text-slate-900">
                {{ product.price | currency }}
              </span>
            </td>

            <!-- Stock -->
            <td class="px-6 py-5">
              <div class="flex flex-col items-center gap-2">
                <div class="w-28 h-2 bg-slate-100 rounded-full overflow-hidden">
                  <div class="h-full rounded-full transition-all duration-700"
                    [style.width.%]="(product.stock / 50) * 100" [class.bg-green-500]="product.stock >= 15"
                    [class.bg-orange-500]="product.stock < 15 && product.stock > 0"
                    [class.bg-red-500]="product.stock === 0">
                  </div>
                </div>
                <span class="text-xs font-bold" [class.text-red-500]="product.stock < 15">
                  {{ product.stock }}
                </span>
              </div>
            </td>

            <!-- Status -->
            <td class="px-6 py-5">
              <div class="flex items-center gap-2 text-xs font-bold uppercase">
                <span class="w-2 h-2 rounded-full" [class.bg-green-500]="product.stock > 15"
                  [class.bg-orange-500]="product.stock <= 15 && product.stock > 0"
                  [class.bg-red-500]="product.stock === 0">
                </span>

                <span [class.text-green-600]="product.stock > 15"
                  [class.text-orange-500]="product.stock <= 15 && product.stock > 0"
                  [class.text-red-600]="product.stock === 0">
                  {{ product.stock > 15 ? 'Healthy' : product.stock > 0 ? 'Low Stock' : 'Out' }}
                </span>
              </div>
            </td>

            <!-- Actions -->
            <td class="px-6 py-5 text-center">
              <div class="flex items-center justify-center gap-1">
                <p-button icon="pi pi-pencil" [text]="true" severity="info" (click)="showEditDialog(product)"
                  styleClass="w-9 h-9 rounded-xl hover:bg-blue-50 transition-all">
                </p-button>

                <p-button icon="pi pi-trash" [text]="true" severity="danger" (click)="deleteProduct(product.id)"
                  styleClass="w-9 h-9 rounded-xl hover:bg-red-50 transition-all">
                </p-button>
              </div>
            </td>

          </tr>
        </ng-template>

      </p-table>
    </div>
  </div>
</div>

<!-- Dialog Add / Edit -->
<p-dialog [header]="isEditMode ? 'Edit Product' : 'Add Product'" [(visible)]="displayDialog" [modal]="true"
  [style]="{ width: '460px' }" styleClass="p-fluid rounded-3xl" [draggable]="false" [resizable]="false">

  <form [formGroup]="productForm" class="flex flex-col gap-5 mt-3">

    <div>
      <label class="block text-sm font-bold text-slate-700 mb-1">Product Name</label>
      <input type="text" pInputText formControlName="name" placeholder="e.g. Italian Espresso"
        class="w-full p-3 rounded-xl bg-slate-50 border-slate-100 focus:bg-white transition-all">
    </div>

    <div class="grid grid-cols-2 gap-4">
      <div>
        <label class="block text-sm font-bold text-slate-700 mb-1">Price</label>
        <p-inputNumber formControlName="price" mode="currency" currency="USD" locale="en-US" styleClass="w-full"
          inputStyleClass="w-full p-3 rounded-xl bg-slate-50 border-slate-100">
        </p-inputNumber>
      </div>

      <div>
        <label class="block text-sm font-bold text-slate-700 mb-1">Stock</label>
        <p-inputNumber formControlName="stock" [showButtons]="true" styleClass="w-full"
          inputStyleClass="w-full p-3 rounded-xl bg-slate-50 border-slate-100">
        </p-inputNumber>
      </div>
    </div>

    <div>
      <label class="block text-sm font-bold text-slate-700 mb-1">Image URL (Optional)</label>
      <input type="text" pInputText formControlName="image" placeholder="https://..."
        class="w-full p-3 rounded-xl bg-slate-50 border-slate-100 focus:bg-white transition-all">

      @if (productForm.get('image')?.value) {
      <div class="mt-4 p-2 rounded-2xl bg-slate-50 border border-slate-100">
        <div class="w-full aspect-video rounded-xl overflow-hidden bg-white border border-slate-100 shadow-sm">
          <img [src]="productForm.get('image')?.value" class="w-full h-full object-cover"
            (error)="$any($event.target).src = 'https://placehold.co/400x225?text=Invalid+Image+URL'">
        </div>
      </div>
      }
    </div>

    <div class="flex justify-end gap-3 mt-6">
      <p-button label="Cancel" icon="pi pi-times" [text]="true" severity="secondary" (click)="displayDialog = false">
      </p-button>

      <p-button [label]="isEditMode ? 'Update Product' : 'Save Product'" icon="pi pi-check" severity="primary"
        (click)="saveProduct()" [disabled]="productForm.invalid"
        styleClass="px-6 rounded-2xl shadow-lg shadow-blue-500/20">
      </p-button>
    </div>

  </form>
</p-dialog>
